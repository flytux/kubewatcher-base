<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>한화생명 통합관리시스템</title>
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/style.css}">
</head>
<script th:src="@{/assets/js/sso.js}"></script>
<script th:src="@{/assets/js/jquery.min.js}"></script>
<script>
    (function() {
        const errorMessage = checkSmError();
        if (!!errorMessage) { procSmEvent(errorMessage); }
    })();
    (function() {
        const next = checkSession();
        if (!!next && SMSSO_LOGIN_FORM !== next) {
            if (window.confirm('sso에 로그인되어 있습니다\r\n해당 계정으로 로그인하시겠습니까?')) {
                window.location.href = next;
            }
        }
    })();
</script>
<body style="background: #f4f7fa;">
    <div class="auth-wrapper">
        <div class="auth-content">
            <div class="auth-bg">
                <span class="r"></span>
                <span class="r s"></span>
                <span class="r s"></span>
                <span class="r" ></span>
                <span class="r s"></span>
                <span class="r" ></span>
            </div>
            <div class="card">
                <form id="app-form" method="POST" action="">
                    <div class="card-body text-center" style="padding-bottom: 0;">
                        <div class="mb-4"><i class="feather icon-unlock auth-icon"></i></div>
                        <div class="tt mb_30">로그인하세요</div>
                        <div class="mb-4">
                            <input type="text" class="form-control" id="app-username" name="username" placeholder="username" required autofocus />
                        </div>
                        <div class="mb-4">
                            <input type="password" class="form-control" id="app-password" name="password" placeholder="password" required />
                            <p th:if="${param.error}" class="text-danger mt-3">입력정보를 확인하세요</p>
                            <p th:if="${param.unknown}" class="text-danger mt-3">등록되지 않은 사용자입니다</p>
                            <p th:if="${param.weird}" class="text-danger mt-3">sso 로그인 처리중 문제 발생</p>
                            <p th:if="${param.smerror}" class="text-danger mt-3">sso 로그인 연결 문제 발생</p>
                        </div>
                        <button class="btn btn-primary mb-4" style="width: 100%;">Login</button>
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    </div>
                </form>
                <form id="sso-form" method="POST" action="">
                    <div class="card-body text-center" style="padding-top: 0;">
                        <button id="btn-sso-submit" class="btn btn-primary mb-4" style="width: 100%;">sso Login</button>
                        <div style="border-top:1px solid #d6d6d6; padding-top:20px;">
                            <p class="text-dark"><img th:src="@{/assets/img/logo.png}" width="20px">한화생명 통합관리시스템</p>
                        </div>
                    </div>
                    <input type="hidden" id="sso-username" name="USER" value="" />
                    <input type="hidden" id="sso-password" name="PASSWORD" value="" />
                    <input type="hidden" name="SMAUTHREASON" value="0" />
                    <input type="hidden" id="sso-redirect-target" name="TARGET" value="" />
                    <input type="hidden" id="sso-agent-name" name="SMAGENTNAME" value="" />
                </form>
            </div>
        </div>
    </div>
<script>
    $(function() {
        $(document).on('click', '#btn-sso-submit', function() {
            $('#sso-username').val($.trim($('#app-username').val()));
            $('#sso-password').val($.trim($('#app-password').val()));
            $('#sso-redirect-target').val(SMSSO_PROTECTED_PAGE);
            $('#sso-agent-name').val(SMSSO_SMAGENTNAME);
            $('#sso-form').prop('action', SMSSO_LOGIN_FCC).submit();
        });
    });
</script>
</body>
</html>